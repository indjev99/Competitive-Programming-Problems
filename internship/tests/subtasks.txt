Subtask 1 (10 points), tests 1-5:   N <= 10,     M <= 20
Subtask 2 (15 points), tests 6-10:  N <= 1100,   M <= 2200
Subtask 3 (15 points), tests 11-15: N <= 13000,  M <= 26000
Subtask 4 (10 points), tests 16-20: N <= 13000,  M <= 10000000
Subtask 5 (30 points), tests 21-25: N <= 500000, M <= 1000000
Subtask 6 (20 points), tests 26-30: N <= 500000, M <= 10000000